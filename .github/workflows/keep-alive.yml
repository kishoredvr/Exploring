name: Keep Supabase Alive

on:
  schedule:
    - cron: "0 */10 * * *"
  workflow_dispatch:

jobs:
  keep-alive:
    runs-on: ubuntu-latest

    steps:
      - name: Send minimal Astrology-form payload to trigger email function
        run: |
          curl -X POST "https://lkvcbpxkpwpoqjlcddgl.functions.supabase.co/submit-form" \
          -H "Content-Type: application/json" \
          -d '{
            "purpose": "Astrology",

            "name": "System KeepAlive",
            "email": "keepalive@system.bot",
            "mobileNumber": "0000000000",

            "astroServiceSelect": "1000",
            "astro_service_tier": "1000",

            "birthDetailsAvailable": "Yes",
            "dob": "1990-01-01",
            "hour": "0",
            "minute": "0",
            "second": "0",
            "explanation": "Not applicable",

            "city": "System",
            "state": "System",
            "country": "System",
            "pincode": "000000",

            "gender": "Male",
            "genderOtherInput": "Not applicable",

            "accuracy": "Yes",

            "contactCountry": "Not applicable",

            "expectations": "Automated keep-alive astrology submission to keep Supabase warm.",

            "payment_status": "not applicable",
            "payment_amount": "0",
            "phonepe_txn_id": "",
            "phonepe_order_id": "",

            "submittedAt": "'"$(date -Iseconds)"'"
          }'
