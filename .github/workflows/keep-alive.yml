name: Keep Supabase Alive

on:
  schedule:
    - cron: "0 */10 * * *"   # every 10 hours
  workflow_dispatch:

jobs:
  keepalive:
    runs-on: ubuntu-latest
    steps:
      - name: Send Other Purpose submission (matches real manual submission)
        run: |
          TIMESTAMP="$(date -Iseconds)"

          read -r -d '' PAYLOAD <<EOF
{
  "purpose": "Other",
  "name": "Automated KeepAlive Bot",
  "email": "keepalive@system.bot",
  "mobileNumber": "9999999999",
  "contactCountry": "India",
  "expectations": "Automated keepalive request to keep Supabase awake.",
  "astro_service_tier": "not applicable",
  "payment_amount": "0",
  "payment_status": "not applicable",
  "submittedAt": "$TIMESTAMP"
}
EOF

          echo "Sending payload:"
          echo "$PAYLOAD"

          curl -X POST "https://lkvcbpxkpwpoqjlcddgl.functions.supabase.co/submit-form" \
            -H "Content-Type: application/json" \
            -d "$PAYLOAD"
